# .github/workflows/package-expert.yml
name: Package Expert Advisor

# This workflow runs when you push to the main branch or run it manually
on:
  push:
    branches:
      - main
  workflow_dispatch: # Allows you to run this workflow manually from the Actions tab

jobs:
  package-expert:
    name: Package MQL5 Expert
    runs-on: ubuntu-latest
    steps:
      # 1. Get the code from your repository
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2. Create the folder structure that MT5 expects
      # We create a temporary 'staging' directory to prepare the files for zipping.
      - name: Create MT5 directory structure
        run: mkdir -p staging/MQL5/Experts/AdaptiveBreakoutAI

      # 3. Copy your EA files from the repo into the staging structure
      # IMPORTANT: This assumes your EA files are in 'eas/AdaptiveBreakoutAI/src/'.
      # If your path is different, change 'eas/AdaptiveBreakoutAI/src/*' below.
      - name: Copy EA files to staging area
        run: cp -r eas/AdaptiveBreakoutAI/src/* staging/MQL5/Experts/AdaptiveBreakoutAI/

      # 4. Create the Zip file from the staging directory
      - name: Create Zip Archive
        run: |
          cd staging
          zip -r ../Expert.zip .

      # 5. Upload the Zip file as a downloadable artifact
      # You will find 'Expert.zip' on the summary page of the workflow run.
      - name: Upload Expert.zip Artifact
        uses: actions/upload-artifact@v4
        with:
          name: Expert-Package
          path: Expert.zip
